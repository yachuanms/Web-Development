<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Ya-Chuan Hsu">
    <title>Registration Page</title>
</head>

<body>
    <h1>
        Registration Page
    </h1>
    <form id="SetupAccount" method="GET" action="formProcessor.html"> <!--form 收集/送出使用者輸入資料-->
        <!--p是段落-->
        <p>*Account Name: <br>(must start with character)</p> <!--只能是字母和數字 但不能是數字開頭或只有數字-->
        <input type="text" id="accountName" name="accountName" placeholder="Account name" required>
        <p>Display Name: </p> <!--(optional)-->
        <input type="text" id="displayName" name="displayName" placeholder="Display name" >
        <p>*Email Address: </p>
        <input type="email" id="email" name="email" placeholder="Email" required>
        <p>*Phone Number: </p>
        <input type="tel"  id="phone" name="phone" pattern="\d{3}-\d{3}-\d{4}" placeholder="123-123-1234" required>
        <p>*Date of Birth: </p>
        <input type="date" id="birthday" name="birthday" required>
        <p>*Zipcode: <br> (5-digit)</p> <!--5碼嗎-->
        <input type="text" id="zipcode" name="zipcode" pattern="\d{5}" placeholder="12345" required>
        <p>*Password: </p><!--打出來的是****-->
        <input type="password" id="password" name="password" required>
        <p>*Password Confirmation: </p>
        <input type="password" id="passwordConfirm" name="passwordConfirm" required>
        
        <input type="hidden" type="time" id="timestamp" name="timestamp" >
        
        <p>
            <input type="reset" value="Clear"> <!--清空所有欄位-->
            <input type="submit" value="Sumbit" onclick="return checkValidation()"><!--檢查是否valid or alert-->
        </p>
        
    </form>
</body>
</html>

<script>
    
    function checkValidation(){
        const accountName = document.getElementById("accountName");
        const email = document.getElementById("email");
        const phone = document.getElementById("phone");
        const birthday = document.getElementById("birthday");
        const password = document.getElementById("password");
        const passwordConfirm = document.getElementById("passwordConfirm");
        const timestamp = document.getElementById("timestamp");
        const now = new Date();
        timestamp.value = now.toISOString();
        
        const birthY = parseInt(birthday.value.split("-")[0]);
        const birthM = parseInt(birthday.value.split("-")[1]);
        const birthD = parseInt(birthday.value.split("-")[2]);
        let age = now.getFullYear()-birthY;
        //alert(age);
        if(birthM > (now.getMonth()+1)){
            age--;    
        }else if(birthM === (now.getMonth()+1)){
            if(birthD > now.getDate()){
                age--;   
            }
        }        
        if (!/^[A-Za-z]$/.test(accountName.value[0])){
            alert("Account name should start with a character! (can not start with number!!)");
            return false;
        }
        //若是不能只有數字開頭 就一定會加字母
        /*if (/^\d+$/.test(accountName.value)){
            alert("Account name should contain a character. (can not only contain numbers!!)")
        }
        */
        if(age < 0){
            alert("Do not enter future date.");
            return false;
        }

        if (age < 18){
            alert("Only individuals above 18 years old can register.");
            return false;
        }
        
        if (password.value != passwordConfirm.value){
            alert("Check your password again!");
            return false;
        }

        return true;
        
    }   

</script>